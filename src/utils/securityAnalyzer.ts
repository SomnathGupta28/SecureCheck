import { ScanResult, SecurityCheck } from '../types';

const SUSPICIOUS_PATTERNS = [
  { pattern: /[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/, threat: 'Uses IP address instead of domain name' },
  { pattern: /[a-z0-9]+-[a-z0-9]+-[a-z0-9]+\.(tk|ml|ga|cf)$/i, threat: 'Suspicious free domain extension' },
  { pattern: /(paypal|amazon|microsoft|google|apple|facebook|instagram|twitter|linkedin|github|dropbox|netflix|spotify|uber|airbnb|ebay|walmart|target|bestbuy|wells-fargo|chase|bankofamerica|citibank|usbank|americanexpress|visa|mastercard|discover|coinbase|binance|kraken|gemini|bitfinex|uniswap|metamask|opensea|rarible|foundation|superrare|async|known|verisign|godaddy|namecheap|digitalocean|linode|vultr|ovh|cloudflare|akamai|fastly|maxcdn|keycdn|bootstrapcdn|jquery|googleapis|gstatic|ytimg|twimg|cdnjs|unpkg|jsdelivr|polyfill|webflow|squarespace|wix|shopify|etsy|aliexpress|alibaba|taobao|tmall|jd|pinduoduo|rakuten|mercadolibre|olx|craigslist|gumtree|leboncoin|marktplaats|finn|blocket|dba|tori|huuto|tradera|allegro|ceneo|heureka|zbozi|mall|emag|okazii|olx|autoplius|skelbiu|aruodas|city24|domoplius|kv|ss|pigu|barbora|rimi|maxima|iki|norfa|lidl|penny|kaufland|carrefour|auchan|metro|selgros|makro|costco|sams|bjs|menards|lowes|depot|harbor|northern|princess|cruise|carnival|royal|norwegian|celebrity|holland|viking|msc|costa|silversea|regent|oceania|azamara|seabourn|crystal|paul|cunard|virgin|p|o|fred|saga|marella|tui|jet2|easyjet|ryanair|wizz|vueling|tap|iberia|lufthansa|klm|air|emirates|qatar|etihad|turkish|singapore|cathay|ana|jal|korean|asiana|china|eastern|southern|hainan|thai|malaysia|garuda|philippine|cebu|jetstar|scoot|tigerair|nok|lion|airasia|indigo|spicejet|goair|vistara|alaska|american|delta|united|southwest|jetblue|spirit|frontier|allegiant|hawaiian|sun|westjet|air|porter|flair|lynx|swoop|canada|british|virgin|easyjet|ryanair|wizz|vueling|tap|iberia|lufthansa|klm|air|emirates|qatar|etihad|turkish|singapore|cathay|ana|jal|korean|asiana|china|eastern|southern|hainan|thai|malaysia|garuda|philippine|cebu|jetstar|scoot|tigerair|nok|lion|airasia|indigo|spicejet|goair|vistara|qantas|jetstar|virgin|tigerair|rex|alliance|bonza|pelican|airnorth|skytrans|sharp|cobham|network|aviation|heliwest|pearl|aviation|rotorwest|aviation|broome|aviation|airnorth|aviation|sharp|aviation|cobham|aviation|network|aviation|heliwest|aviation|pearl|aviation|rotorwest|aviation|broome|aviation)[\w-]*\.(com|org|net|info|biz|co|io|me|tv|cc|tk|ml|ga|cf|shop|store|online|site|website|web|app|digital|tech|cloud|space|world|global|international|solutions|services|systems|network|group|company|corporation|enterprise|business|professional|commercial|industry|industrial|manufacturing|production|development|software|technology|innovation|research|science|education|academic|university|college|school|institute|foundation|organization|association|society|community|social|network|media|news|press|blog|magazine|journal|publication|broadcasting|radio|television|streaming|entertainment|gaming|sports|fitness|health|medical|healthcare|pharmacy|hospital|clinic|dental|veterinary|legal|law|attorney|lawyer|finance|financial|banking|investment|insurance|real|estate|property|construction|architecture|engineering|consulting|advisory|management|marketing|advertising|promotion|sales|retail|wholesale|distribution|logistics|transportation|shipping|delivery|travel|tourism|hospitality|hotel|resort|restaurant|food|beverage|catering|beauty|fashion|clothing|accessories|jewelry|watches|electronics|computers|mobile|phones|tablets|laptops|gadgets|appliances|furniture|home|garden|tools|equipment|machinery|automotive|cars|trucks|motorcycles|boats|marine|aviation|aerospace|defense|security|surveillance|monitoring|testing|inspection|certification|compliance|regulatory|government|public|municipal|federal|state|local|international|global|worldwide|universal|standard|premium|luxury|exclusive|private|personal|individual|custom|personalized|specialized|professional|expert|advanced|pro|plus|max|ultra|super|mega|giant|big|large|huge|massive|enormous|tiny|small|mini|micro|nano|quick|fast|rapid|instant|immediate|direct|express|priority|urgent|emergency|24|7|365|24\/7|247|unlimited|infinite|maximum|minimum|optimal|best|top|first|number|one|leading|premier|primary|main|principal|central|core|essential|fundamental|basic|simple|easy|smart|intelligent|clever|innovative|creative|original|unique|special|exclusive|rare|limited|edition|collection|series|set|kit|package|bundle|combo|deal|offer|discount|sale|bargain|cheap|affordable|budget|economy|value|quality|premium|luxury|deluxe|superior|excellent|outstanding|amazing|awesome|fantastic|incredible|unbelievable|extraordinary|remarkable|exceptional|magnificent|marvelous|wonderful|terrific|great|good|nice|fine|ok|okay|average|normal|standard|regular|common|ordinary|typical|usual|traditional|classic|vintage|retro|modern|contemporary|current|latest|newest|recent|fresh|new|updated|upgraded|improved|enhanced|optimized|advanced|sophisticated|complex|complicated|difficult|hard|challenging|tough|strong|powerful|robust|reliable|dependable|trustworthy|secure|safe|protected|guaranteed|certified|verified|approved|authorized|licensed|registered|official|legitimate|legal|valid|authentic|genuine|real|actual|true|honest|transparent|open|public|free|freedom|liberty|democracy|justice|equality|fairness|peace|harmony|unity|cooperation|collaboration|partnership|teamwork|leadership|management|administration|governance|authority|control|power|influence|impact|effect|result|outcome|success|achievement|accomplishment|victory|win|triumph|excellence|perfection|mastery|expertise|skill|talent|ability|capability|capacity|potential|opportunity|chance|possibility|probability|likelihood|certainty|assurance|confidence|trust|faith|belief|hope|optimism|positivity|happiness|joy|pleasure|satisfaction|contentment|fulfillment|success|prosperity|wealth|fortune|luck|blessing|miracle|wonder|magic|mystery|secret|hidden|private|confidential|classified|restricted|exclusive|limited|special|unique|rare|precious|valuable|priceless|expensive|costly|cheap|affordable|reasonable|fair|just|right|correct|accurate|precise|exact|perfect|flawless|ideal|optimal|best|excellent|outstanding|superior|high|top|first|leading|premier|primary|main|principal|central|core|essential|fundamental|basic|simple|easy|quick|fast|rapid|instant|immediate|direct|express|priority|urgent|emergency|critical|important|significant|major|serious|severe|extreme|intense|strong|powerful|robust|solid|stable|secure|safe|protected|guaranteed|reliable|dependable|trustworthy|honest|transparent|open|public|free|available|accessible|reachable|obtainable|achievable|possible|probable|likely|certain|sure|definite|absolute|complete|total|full|entire|whole|comprehensive|extensive|broad|wide|large|big|huge|massive|enormous|giant|mega|super|ultra|maximum|minimum|optimal|average|normal|standard|regular|common|ordinary|typical|usual|traditional|classic|vintage|retro|modern|contemporary|current|latest|newest|recent|fresh|new|updated|upgraded|improved|enhanced|optimized|advanced|sophisticated|complex|complicated|difficult|hard|challenging|tough|strong|powerful|robust|reliable|dependable|trustworthy|secure|safe|protected|guaranteed|certified|verified|approved|authorized|licensed|registered|official|legitimate|legal|valid|authentic|genuine|real|actual|true)\.(com|org|net|info|biz|co|io|me|tv|cc|tk|ml|ga|cf|shop|store|online|site|website|web|app|digital|tech|cloud|space|world|global|international|solutions|services|systems|network|group|company|corporation|enterprise|business|professional|commercial|industry|industrial|manufacturing|production|development|software|technology|innovation|research|science|education|academic|university|college|school|institute|foundation|organization|association|society|community|social|network|media|news|press|blog|magazine|journal|publication|broadcasting|radio|television|streaming|entertainment|gaming|sports|fitness|health|medical|healthcare|pharmacy|hospital|clinic|dental|veterinary|legal|law|attorney|lawyer|finance|financial|banking|investment|insurance|real|estate|property|construction|architecture|engineering|consulting|advisory|management|marketing|advertising|promotion|sales|retail|wholesale|distribution|logistics|transportation|shipping|delivery|travel|tourism|hospitality|hotel|resort|restaurant|food|beverage|catering|beauty|fashion|clothing|accessories|jewelry|watches|electronics|computers|mobile|phones|tablets|laptops|gadgets|appliances|furniture|home|garden|tools|equipment|machinery|automotive|cars|trucks|motorcycles|boats|marine|aviation|aerospace|defense|security|surveillance|monitoring|testing|inspection|certification|compliance|regulatory|government|public|municipal|federal|state|local|international|global|worldwide|universal|standard|premium|luxury|exclusive|private|personal|individual|custom|personalized|specialized|professional|expert|advanced|pro|plus|max|ultra|super|mega|giant|big|large|huge|massive|enormous|tiny|small|mini|micro|nano|quick|fast|rapid|instant|immediate|direct|express|priority|urgent|emergency|24|7|365|24\/7|247|unlimited|infinite|maximum|minimum|optimal|best|top|first|number|one|leading|premier|primary|main|principal|central|core|essential|fundamental|basic|simple|easy|smart|intelligent|clever|innovative|creative|original|unique|special|exclusive|rare|limited|edition|collection|series|set|kit|package|bundle|combo|deal|offer|discount|sale|bargain|cheap|affordable|budget|economy|value|quality|premium|luxury|deluxe|superior|excellent|outstanding|amazing|awesome|fantastic|incredible|unbelievable|extraordinary|remarkable|exceptional|magnificent|marvelous|wonderful|terrific|great|good|nice|fine|ok|okay|average|normal|standard|regular|common|ordinary|typical|usual|traditional|classic|vintage|retro|modern|contemporary|current|latest|newest|recent|fresh|new|updated|upgraded|improved|enhanced|optimized|advanced|sophisticated|complex|complicated|difficult|hard|challenging|tough|strong|powerful|robust|reliable|dependable|trustworthy|secure|safe|protected|guaranteed|certified|verified|approved|authorized|licensed|registered|official|legitimate|legal|valid|authentic|genuine|real|actual|true|honest|transparent|open|public|free|freedom|liberty|democracy|justice|equality|fairness|peace|harmony|unity|cooperation|collaboration|partnership|teamwork|leadership|management|administration|governance|authority|control|power|influence|impact|effect|result|outcome|success|achievement|accomplishment|victory|win|triumph|excellence|perfection|mastery|expertise|skill|talent|ability|capability|capacity|potential|opportunity|chance|possibility|probability|likelihood|certainty|assurance|confidence|trust|faith|belief|hope|optimism|positivity|happiness|joy|pleasure|satisfaction|contentment|fulfillment|success|prosperity|wealth|fortune|luck|blessing|miracle|wonder|magic|mystery|secret|hidden|private|confidential|classified|restricted|exclusive|limited|special|unique|rare|precious|valuable|priceless|expensive|costly|cheap|affordable|reasonable|fair|just|right|correct|accurate|precise|exact|perfect|flawless|ideal|optimal|best|excellent|outstanding|superior|high|top|first|leading|premier|primary|main|principal|central|core|essential|fundamental|basic|simple|easy|quick|fast|rapid|instant|immediate|direct|express|priority|urgent|emergency|critical|important|significant|major|serious|severe|extreme|intense|strong|powerful|robust|solid|stable|secure|safe|protected|guaranteed|reliable|dependable|trustworthy|honest|transparent|open|public|free|available|accessible|reachable|obtainable|achievable|possible|probable|likely|certain|sure|definite|absolute|complete|total|full|entire|whole|comprehensive|extensive|broad|wide|large|big|huge|massive|enormous|giant|mega|super|ultra|maximum|minimum|optimal|average|normal|standard|regular|common|ordinary|typical|usual|traditional|classic|vintage|retro|modern|contemporary|current|latest|newest|recent|fresh|new|updated|upgraded|improved|enhanced|optimized|advanced|sophisticated|complex|complicated|difficult|hard|challenging|tough|strong|powerful|robust|reliable|dependable|trustworthy|secure|safe|protected|guaranteed|certified|verified|approved|authorized|licensed|registered|official|legitimate|legal|valid|authentic|genuine|real|actual|true)$/i, threat: 'Potential brand impersonation' },
  { pattern: /(?:secure|safe|verify|update|confirm|login|account|billing|payment|suspended|expired|urgent|immediate|click|now|limited|offer|free|winner|congratulations|lottery|prize|reward|bonus|gift|claim|redeem|activate|unlock|restore|recover|reset|change|modify|upgrade|downgrade|cancel|close|delete|remove|block|ban|suspend|disable|enable|allow|permit|grant|access|entry|admission|membership|subscription|registration|signup|signin|login|logout|logoff|signout|checkout|purchase|buy|order|cart|basket|wishlist|favorite|bookmark|save|download|upload|share|send|receive|get|obtain|acquire|achieve|earn|win|gain|benefit|profit|advantage|opportunity|chance|deal|offer|discount|sale|promotion|coupon|code|voucher|ticket|pass|card|certificate|license|permit|authorization|approval|permission|access|entry|admission|membership|subscription|registration|signup|signin|login|logout|logoff|signout|checkout|purchase|buy|order|cart|basket|wishlist|favorite|bookmark|save|download|upload|share|send|receive|get|obtain|acquire|achieve|earn|win|gain|benefit|profit|advantage|opportunity|chance|deal|offer|discount|sale|promotion|coupon|code|voucher|ticket|pass|card|certificate|license|permit|authorization|approval|permission).*(?:paypal|amazon|microsoft|google|apple|facebook|instagram|twitter|linkedin|github|dropbox|netflix|spotify|uber|airbnb|ebay|walmart|target|bestbuy|wells-fargo|chase|bankofamerica|citibank|usbank|americanexpress|visa|mastercard|discover|coinbase|binance|kraken|gemini|bitfinex|uniswap|metamask|opensea|rarible|foundation|superrare|async|known|verisign|godaddy|namecheap|digitalocean|linode|vultr|ovh|cloudflare|akamai|fastly|maxcdn|keycdn|bootstrapcdn|jquery|googleapis|gstatic|ytimg|twimg|cdnjs|unpkg|jsdelivr|polyfill|webflow|squarespace|wix|shopify|etsy|aliexpress|alibaba|taobao|tmall|jd|pinduoduo|rakuten|mercadolibre|olx|craigslist|gumtree|leboncoin|marktplaats|finn|blocket|dba|tori|huuto|tradera|allegro|ceneo|heureka|zbozi|mall|emag|okazii|olx|autoplius|skelbiu|aruodas|city24|domoplius|kv|ss|pigu|barbora|rimi|maxima|iki|norfa|lidl|penny|kaufland|carrefour|auchan|metro|selgros|makro|costco|sams|bjs|menards|lowes|depot|harbor|northern|princess|cruise|carnival|royal|norwegian|celebrity|holland|viking|msc|costa|silversea|regent|oceania|azamara|seabourn|crystal|paul|cunard|virgin|p|o|fred|saga|marella|tui|jet2|easyjet|ryanair|wizz|vueling|tap|iberia|lufthansa|klm|air|emirates|qatar|etihad|turkish|singapore|cathay|ana|jal|korean|asiana|china|eastern|southern|hainan|thai|malaysia|garuda|philippine|cebu|jetstar|scoot|tigerair|nok|lion|airasia|indigo|spicejet|goair|vistara|alaska|american|delta|united|southwest|jetblue|spirit|frontier|allegiant|hawaiian|sun|westjet|air|porter|flair|lynx|swoop|canada|british|virgin|easyjet|ryanair|wizz|vueling|tap|iberia|lufthansa|klm|air|emirates|qatar|etihad|turkish|singapore|cathay|ana|jal|korean|asiana|china|eastern|southern|hainan|thai|malaysia|garuda|philippine|cebu|jetstar|scoot|tigerair|nok|lion|airasia|indigo|spicejet|goair|vistara|qantas|jetstar|virgin|tigerair|rex|alliance|bonza|pelican|airnorth|skytrans|sharp|cobham|network|aviation|heliwest|pearl|aviation|rotorwest|aviation|broome|aviation|airnorth|aviation|sharp|aviation|cobham|aviation|network|aviation|heliwest|aviation|pearl|aviation|rotorwest|aviation|broome|aviation)/i, threat: 'Phishing keywords with brand names' },
  { pattern: /\.(?:tk|ml|ga|cf|pw|top|click|download|stream|zip|rar|exe|bat|com|pif|scr|vbs|js|jar|app|dmg|pkg|deb|rpm|msi|iso|img|bin|run|command|action|install|setup|update|patch|crack|keygen|serial|license|activation|registration|trial|demo|free|full|premium|pro|plus|max|ultra|super|mega|giant|big|large|huge|massive|enormous|tiny|small|mini|micro|nano|quick|fast|rapid|instant|immediate|direct|express|priority|urgent|emergency|24|7|365|24\/7|247|unlimited|infinite|maximum|minimum|optimal|best|top|first|number|one|leading|premier|primary|main|principal|central|core|essential|fundamental|basic|simple|easy|smart|intelligent|clever|innovative|creative|original|unique|special|exclusive|rare|limited|edition|collection|series|set|kit|package|bundle|combo|deal|offer|discount|sale|bargain|cheap|affordable|budget|economy|value|quality|premium|luxury|deluxe|superior|excellent|outstanding|amazing|awesome|fantastic|incredible|unbelievable|extraordinary|remarkable|exceptional|magnificent|marvelous|wonderful|terrific|great|good|nice|fine|ok|okay|average|normal|standard|regular|common|ordinary|typical|usual|traditional|classic|vintage|retro|modern|contemporary|current|latest|newest|recent|fresh|new|updated|upgraded|improved|enhanced|optimized|advanced|sophisticated|complex|complicated|difficult|hard|challenging|tough|strong|powerful|robust|reliable|dependable|trustworthy|secure|safe|protected|guaranteed|certified|verified|approved|authorized|licensed|registered|official|legitimate|legal|valid|authentic|genuine|real|actual|true|honest|transparent|open|public|free|freedom|liberty|democracy|justice|equality|fairness|peace|harmony|unity|cooperation|collaboration|partnership|teamwork|leadership|management|administration|governance|authority|control|power|influence|impact|effect|result|outcome|success|achievement|accomplishment|victory|win|triumph|excellence|perfection|mastery|expertise|skill|talent|ability|capability|capacity|potential|opportunity|chance|possibility|probability|likelihood|certainty|assurance|confidence|trust|faith|belief|hope|optimism|positivity|happiness|joy|pleasure|satisfaction|contentment|fulfillment|success|prosperity|wealth|fortune|luck|blessing|miracle|wonder|magic|mystery|secret|hidden|private|confidential|classified|restricted|exclusive|limited|special|unique|rare|precious|valuable|priceless|expensive|costly|cheap|affordable|reasonable|fair|just|right|correct|accurate|precise|exact|perfect|flawless|ideal|optimal|best|excellent|outstanding|superior|high|top|first|leading|premier|primary|main|principal|central|core|essential|fundamental|basic|simple|easy|quick|fast|rapid|instant|immediate|direct|express|priority|urgent|emergency|critical|important|significant|major|serious|severe|extreme|intense|strong|powerful|robust|solid|stable|secure|safe|protected|guaranteed|reliable|dependable|trustworthy|honest|transparent|open|public|free|available|accessible|reachable|obtainable|achievable|possible|probable|likely|certain|sure|definite|absolute|complete|total|full|entire|whole|comprehensive|extensive|broad|wide|large|big|huge|massive|enormous|giant|mega|super|ultra|maximum|minimum|optimal|average|normal|standard|regular|common|ordinary|typical|usual|traditional|classic|vintage|retro|modern|contemporary|current|latest|newest|recent|fresh|new|updated|upgraded|improved|enhanced|optimized|advanced|sophisticated|complex|complicated|difficult|hard|challenging|tough|strong|powerful|robust|reliable|dependable|trustworthy|secure|safe|protected|guaranteed|certified|verified|approved|authorized|licensed|registered|official|legitimate|legal|valid|authentic|genuine|real|actual|true)$/i, threat: 'Suspicious file extension or free domain' },
  { pattern: /(?:bit\.ly|tinyurl|goo\.gl|t\.co|short\.link|tiny\.cc|is\.gd|buff\.ly|ow\.ly|s2r\.co|smarturl\.it|clicky\.me|budurl\.com|bc\.vc|u\.to|qr\.ae|adf\.ly|j\.mp|x\.co|prettylinkpro\.com|scrnch\.me|filoops\.info|linkbucks\.com|any\.gs|virl\.com|z\.ai)\/|(?:t\.me|discord\.gg|chat\.whatsapp\.com|invite\.gg|dsc\.gg|discord\.io|disboard\.org|top\.gg|discord\.com\/invite|telegram\.me|telegram\.dog|telegram\.org|tlgrm\.eu|tgraph\.io|telegra\.ph|t\.me|web\.telegram\.org|desktop\.telegram\.org|macos\.telegram\.org|telegram\.org\/apps|core\.telegram\.org|contest\.com|fragment\.com|ton\.org|tonwhales\.com|tonkeeper\.com|toncoin\.org|tonscan\.org|tonapi\.io|toncenter\.com|tontech\.io|tonfura\.com|tonhub\.com|tonsurf\.com|tonraffles\.app|getgems\.io|tonplay\.io|tonstarter\.com|tegro\.money|ston\.fi|dedust\.io|tonswap\.org|megaton\.fi|tonpump\.live|blum\.codes|notcoin\.tg|hamster\.tg|tapswap\.ai|yescoin\.gold|major\.bot|moonbix\.game|tomarket\.ai|cats\.dog|paws\.community|rocky\.rabbit|mdogs\.community|okx\.com|binance\.com|coinbase\.com|crypto\.com|kucoin\.com|gate\.io|mexc\.com|bitget\.com|bybit\.com|huobi\.com|bingx\.com|bitfinex\.com|kraken\.com|gemini\.com|coinlist\.co|compound\.finance|aave\.com|uniswap\.org|sushiswap\.fi|pancakeswap\.finance|quickswap\.exchange|balancer\.fi|curve\.fi|1inch\.io|0x\.org|paraswap\.io|dydx\.exchange|makerdao\.com|yearn\.finance|synthetix\.io|snx\.io|badger\.finance|harvest\.finance|pickle\.finance|cream\.finance|alpha\.finance|belt\.fi|pancakebunny\.finance|venus\.io|autofarm\.network|beefy\.finance|farm\.army|wault\.finance|mdx\.com|jetswap\.finance|apeswap\.finance|cafeswap\.finance|pantherswap\.com|cheeseswap\.app|goosedefi\.com|swamp\.finance|dopple\.finance|eleven\.finance|iron\.finance|polycat\.finance|polyzap\.finance|polywhale\.finance|polydex\.fi|polyswap\.exchange|polymarket\.com|kleros\.io|aragon\.org|snapshot\.org|boardroom\.info|commonwealth\.im|discourse\.org|reddit\.com|twitter\.com|facebook\.com|instagram\.com|tiktok\.com|youtube\.com|twitch\.tv|linkedin\.com|github\.com|gitlab\.com|bitbucket\.org|stackoverflow\.com|medium\.com|substack\.com|mirror\.xyz|hashnode\.com|dev\.to|hackernoon\.com|forbes\.com|techcrunch\.com|venturebeat\.com|theverge\.com|engadget\.com|wired\.com|arstechnica\.com|cnet\.com|zdnet\.com|pcmag\.com|tomshardware\.com|anandtech\.com|extremetech\.com|digitaltrends\.com|makeuseof\.com|howtogeek\.com|lifehacker\.com|gizmodo\.com|mashable\.com|buzzfeed\.com|vice\.com|vox\.com|slate\.com|salon\.com|huffpost\.com|dailymail\.co\.uk|theguardian\.com|bbc\.com|cnn\.com|nytimes\.com|wsj\.com|bloomberg\.com|reuters\.com|ap\.org|npr\.org|pbs\.org|abc\.com|nbc\.com|cbs\.com|fox\.com|espn\.com|skysports\.com|bbc\.co\.uk|itv\.com|channel4\.com|five\.tv|dave\.tv|comedy\.co\.uk|e4\.com|more4\.com|film4\.com|yesterday\.co\.uk|gold\.tv|alibi\.co\.uk|eden\.tv|good\.food|home\.co\.uk|really\.co\.uk|quest\.tv|dmax\.co\.uk|eurosport\.co\.uk|discovery\.co\.uk|animal\.planet|history\.co\.uk|nat\.geo|sky\.com|virgin\.media|bt\.com|ee\.co\.uk|o2\.co\.uk|three\.co\.uk|vodafone\.co\.uk|plusnet\.com|talktalk\.co\.uk|now\.tv|amazon\.co\.uk|netflix\.com|disney\.com|hulu\.com|hbo\.com|showtime\.com|starz\.com|epix\.com|paramount\.com|peacock\.tv|apple\.tv|crunchyroll\.com|funimation\.com|vrv\.co|animelab\.com|wakanim\.tv|crunchyroll\.com|funimation\.com|vrv\.co|animelab\.com|wakanim\.tv|spotify\.com|apple\.music|amazon\.music|youtube\.music|pandora\.com|iheart\.com|tunein\.com|siriusxm\.com|deezer\.com|tidal\.com|qobuz\.com|bandcamp\.com|soundcloud\.com|mixcloud\.com|8tracks\.com|last\.fm|shazam\.com|musixmatch\.com|genius\.com|azlyrics\.com|metrolyrics\.com|lyricsfreak\.com|lyricsmania\.com|lyricsmode\.com|lyricstranslate\.com|lyricsfind\.com|songlyrics\.com|lyricsbox\.com|lyricsroll\.com|lyricsboat\.com|lyricsbell\.com|lyricsera\.com|lyricsoff\.com|lyricslib\.com|lyricsreg\.com|lyricsworld\.com|lyricsyouknow\.com|lyricsplanet\.com|lyricsed\.com|lyricskeeper\.com|lyricsget\.com|lyricsology\.com|lyricsmania\.com|lyricsfreak\.com|azlyrics\.com|metrolyrics\.com|genius\.com|songlyrics\.com|lyricsbox\.com|lyricsroll\.com|lyricsboat\.com|lyricsbell\.com|lyricsera\.com|lyricsoff\.com|lyricslib\.com|lyricsreg\.com|lyricsworld\.com|lyricsyouknow\.com|lyricsplanet\.com|lyricsed\.com|lyricskeeper\.com|lyricsget\.com|lyricsology\.com)/i, threat: 'Suspicious shortened URL or messaging platform' },
  { pattern: /(?:download|install|update|patch|crack|keygen|serial|license|activation|registration|trial|demo|free|full|premium|pro|plus|max|ultra|super|mega|giant|big|large|huge|massive|enormous|tiny|small|mini|micro|nano|quick|fast|rapid|instant|immediate|direct|express|priority|urgent|emergency).*(?:exe|msi|dmg|pkg|deb|rpm|app|apk|ipa|zip|rar|7z|tar|gz|bz2|xz|iso|img|bin|run|command|action|install|setup|update|patch|crack|keygen|serial|license|activation|registration|trial|demo|free|full|premium|pro|plus|max|ultra|super|mega|giant|big|large|huge|massive|enormous|tiny|small|mini|micro|nano|quick|fast|rapid|instant|immediate|direct|express|priority|urgent|emergency)/i, threat: 'Suspicious download link' },
  { pattern: /(?:urgent|immediate|expires|limited|act|now|click|here|verify|confirm|update|secure|suspend|block|ban|disable|delete|remove|close|cancel|terminate|expire|deactivate|lock|freeze|hold|pending|review|investigation|suspicious|unusual|unauthorized|invalid|incorrect|wrong|error|problem|issue|concern|alert|warning|notice|notification|message|email|text|sms|call|phone|contact|support|help|assist|service|department|team|agent|representative|specialist|expert|professional|advisor|consultant|manager|director|administrator|supervisor|coordinator|operator|technician|engineer|developer|programmer|analyst|designer|architect|planner|strategist|marketer|salesperson|representative|agent|broker|dealer|vendor|supplier|provider|contractor|freelancer|consultant|advisor|coach|mentor|trainer|instructor|teacher|educator|professor|researcher|scientist|doctor|physician|nurse|therapist|counselor|psychologist|psychiatrist|social|worker|volunteer|activist|advocate|campaigner|organizer|leader|president|ceo|cto|cfo|coo|cmo|chairman|founder|owner|partner|shareholder|investor|entrepreneur|business|person|individual|professional|expert|specialist|authority|celebrity|influencer|blogger|youtuber|streamer|podcaster|journalist|reporter|writer|author|editor|publisher|producer|director|actor|actress|musician|artist|designer|photographer|videographer|filmmaker|animator|illustrator|graphic|designer|web|developer|software|engineer|data|scientist|machine|learning|artificial|intelligence|blockchain|cryptocurrency|bitcoin|ethereum|nft|defi|web3|metaverse|virtual|reality|augmented|reality|mixed|reality|gaming|esports|sports|fitness|health|wellness|nutrition|diet|weight|loss|muscle|gain|bodybuilding|powerlifting|crossfit|yoga|pilates|meditation|mindfulness|spirituality|religion|philosophy|psychology|sociology|anthropology|history|geography|politics|economics|finance|business|marketing|advertising|sales|customer|service|human|resources|management|leadership|strategy|consulting|coaching|training|education|learning|development|personal|professional|career|job|work|employment|recruitment|hiring|staffing|outsourcing|freelancing|gig|economy|remote|work|digital|nomad|travel|tourism|hospitality|accommodation|hotel|resort|restaurant|food|beverage|cooking|recipe|nutrition|health|fitness|beauty|fashion|style|clothing|accessories|jewelry|watches|shoes|bags|makeup|skincare|hair|care|personal|care|hygiene|grooming|spa|wellness|relaxation|massage|therapy|treatment|medical|healthcare|pharmacy|hospital|clinic|dental|vision|insurance|legal|law|attorney|lawyer|real|estate|property|home|house|apartment|condo|rental|mortgage|loan|credit|debt|investment|retirement|savings|budget|finance|tax|accounting|bookkeeping|payroll|hr|human|resources|management|leadership|strategy|consulting|coaching|training|education|learning|development|personal|professional|career|job|work|employment|recruitment|hiring|staffing|outsourcing|freelancing|gig|economy|remote|work|digital|nomad|travel|tourism|hospitality|accommodation|hotel|resort|restaurant|food|beverage|cooking|recipe|nutrition|health|fitness|beauty|fashion|style|clothing|accessories|jewelry|watches|shoes|bags|makeup|skincare|hair|care|personal|care|hygiene|grooming|spa|wellness|relaxation|massage|therapy|treatment|medical|healthcare|pharmacy|hospital|clinic|dental|vision|insurance|legal|law|attorney|lawyer|real|estate|property|home|house|apartment|condo|rental|mortgage|loan|credit|debt|investment|retirement|savings|budget|finance|tax|accounting|bookkeeping|payroll|hr|human|resources|management|leadership|strategy|consulting|coaching|training|education|learning|development|personal|professional|career|job|work|employment|recruitment|hiring|staffing|outsourcing|freelancing|gig|economy|remote|work|digital|nomad|travel|tourism|hospitality|accommodation|hotel|resort|restaurant|food|beverage|cooking|recipe|nutrition|health|fitness|beauty|fashion|style|clothing|accessories|jewelry|watches|shoes|bags|makeup|skincare|hair|care|personal|care|hygiene|grooming|spa|wellness|relaxation|massage|therapy|treatment|medical|healthcare|pharmacy|hospital|clinic|dental|vision|insurance|legal|law|attorney|lawyer|real|estate|property|home|house|apartment|condo|rental|mortgage|loan|credit|debt|investment|retirement|savings|budget|finance|tax|accounting|bookkeeping|payroll)/i, threat: 'Urgent action phishing language' }
];

const TRUSTED_DOMAINS = [
  'google.com', 'youtube.com', 'facebook.com', 'twitter.com', 'instagram.com',
  'linkedin.com', 'github.com', 'stackoverflow.com', 'reddit.com', 'wikipedia.org',
  'amazon.com', 'microsoft.com', 'apple.com', 'netflix.com', 'spotify.com',
  'paypal.com', 'stripe.com', 'dropbox.com', 'zoom.us', 'slack.com'
];

const SUSPICIOUS_DOMAINS = [
  '.tk', '.ml', '.ga', '.cf', '.pw', '.top', '.click', '.download', '.stream'
];

export const analyzeUrl = (url: string): Promise<ScanResult> => {
  return new Promise((resolve) => {
    const startTime = Date.now();
    
    // Simulate analysis time
    setTimeout(() => {
      const normalizedUrl = url.startsWith('http') ? url : `https://${url}`;
      const threats: string[] = [];
      let riskScore = 0;
      
      // Check for suspicious patterns
      SUSPICIOUS_PATTERNS.forEach(({ pattern, threat }) => {
        if (pattern.test(normalizedUrl)) {
          threats.push(threat);
          riskScore += 25;
        }
      });
      
      // Check domain reputation
      const domain = normalizedUrl.match(/https?:\/\/([^\/]+)/)?.[1] || '';
      
      if (TRUSTED_DOMAINS.some(trusted => domain.includes(trusted))) {
        riskScore = Math.max(0, riskScore - 30);
      }
      
      if (SUSPICIOUS_DOMAINS.some(suspicious => domain.endsWith(suspicious))) {
        threats.push('Uses suspicious domain extension');
        riskScore += 20;
      }
      
      // Check for HTTPS
      if (!normalizedUrl.startsWith('https://')) {
        threats.push('Not using secure HTTPS protocol');
        riskScore += 15;
      }
      
      // Determine risk level
      let riskLevel: 'low' | 'medium' | 'high' | 'critical';
      if (riskScore >= 80) riskLevel = 'critical';
      else if (riskScore >= 60) riskLevel = 'high';
      else if (riskScore >= 30) riskLevel = 'medium';
      else riskLevel = 'low';
      
      const recommendations: string[] = [];
      if (riskLevel !== 'low') {
        recommendations.push('Verify the URL sender before clicking');
        recommendations.push('Check for spelling errors in the domain name');
        recommendations.push('Look for secure HTTPS connection');
        recommendations.push('Be cautious of urgent or threatening language');
      }
      
      const scanDuration = Date.now() - startTime;
      
      resolve({
        url: normalizedUrl,
        isSecure: riskLevel === 'low',
        riskLevel,
        riskScore: Math.min(100, riskScore),
        threats,
        recommendations,
        scannedAt: new Date(),
        scanDuration
      });
    }, 1500 + Math.random() * 2000); // Random delay between 1.5-3.5 seconds
  });
};

export const performSecurityChecks = (url: string): SecurityCheck[] => {
  const checks: SecurityCheck[] = [];
  const normalizedUrl = url.startsWith('http') ? url : `https://${url}`;
  
  // HTTPS Check
  checks.push({
    name: 'HTTPS Security',
    status: normalizedUrl.startsWith('https://') ? 'passed' : 'failed',
    description: normalizedUrl.startsWith('https://') 
      ? 'Website uses secure HTTPS protocol'
      : 'Website does not use secure HTTPS protocol'
  });
  
  // Domain Check
  const domain = normalizedUrl.match(/https?:\/\/([^\/]+)/)?.[1] || '';
  const isTrusted = TRUSTED_DOMAINS.some(trusted => domain.includes(trusted));
  const isSuspicious = SUSPICIOUS_DOMAINS.some(suspicious => domain.endsWith(suspicious));
  
  checks.push({
    name: 'Domain Reputation',
    status: isTrusted ? 'passed' : isSuspicious ? 'failed' : 'warning',
    description: isTrusted 
      ? 'Domain is from a trusted source'
      : isSuspicious 
        ? 'Domain uses suspicious extension'
        : 'Domain reputation unknown'
  });
  
  // Phishing Pattern Check
  const hasPhishingPatterns = SUSPICIOUS_PATTERNS.some(({ pattern }) => pattern.test(normalizedUrl));
  checks.push({
    name: 'Phishing Patterns',
    status: hasPhishingPatterns ? 'failed' : 'passed',
    description: hasPhishingPatterns 
      ? 'URL contains suspicious phishing patterns'
      : 'No phishing patterns detected'
  });
  
  // URL Length Check
  checks.push({
    name: 'URL Length',
    status: normalizedUrl.length > 100 ? 'warning' : 'passed',
    description: normalizedUrl.length > 100 
      ? 'URL is unusually long, which may indicate obfuscation'
      : 'URL length is normal'
  });
  
  return checks;
};